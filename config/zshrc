# Managed by Shell Bootstrap Kit.
# Do not edit this file directly after deploy.
# Put personal changes in: ~/.zshrc.local

export ZSH="${ZSH:-$HOME/.oh-my-zsh}"
export ZSH_CUSTOM="${ZSH_CUSTOM:-$ZSH/custom}"

ZSH_THEME="${ZSH_THEME:-bira}"

plugins=(
  git
  virtualenv
  python
  colored-man-pages
)

if [[ -f "$HOME/.zshrc.platform" ]]; then
  source "$HOME/.zshrc.platform"
fi

# Avoid prompts/hangs in headless or no-TTY contexts (automation runners).
if [[ ! -o interactive ]]; then
  return 0
fi
if [[ ! -t 0 || ! -t 1 ]]; then
  return 0
fi

: "${ZSH_DISABLE_COMPFIX:=true}"
: "${DISABLE_AUTO_UPDATE:=true}"

if [[ -f "$ZSH/oh-my-zsh.sh" ]]; then
  source "$ZSH/oh-my-zsh.sh"
fi

if [[ -f "$ZSH_CUSTOM/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh" ]]; then
  source "$ZSH_CUSTOM/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh"
fi

# Must be sourced last.
if [[ -f "$ZSH_CUSTOM/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" ]]; then
  source "$ZSH_CUSTOM/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh"
fi

# Node.js (nvm) - optional, but needed for Codex CLI when installed under WSL.
export NVM_DIR="${NVM_DIR:-$HOME/.nvm}"
if [[ -s "$NVM_DIR/nvm.sh" ]]; then
  source "$NVM_DIR/nvm.sh"
  nvm use --silent default >/dev/null 2>&1 || nvm use --silent node >/dev/null 2>&1 || true

  _nvm_codex="$(ls -1 "$NVM_DIR"/versions/node/*/bin/codex 2>/dev/null | tail -n 1 || true)"
  if [[ -n "$_nvm_codex" ]]; then
    export CODEX_BIN="$_nvm_codex"
    codex() { "$CODEX_BIN" "$@"; }
  fi
  unset _nvm_codex
fi

# pyenv (optional)
export PYENV_ROOT="$HOME/.pyenv"
if [[ -d "$PYENV_ROOT" ]]; then
  export PATH="$PYENV_ROOT/bin:$PATH"
  if command -v pyenv >/dev/null 2>&1; then
    eval "$(pyenv init - zsh)"
  fi
fi

if [[ -f "$HOME/.zshrc.local" ]]; then
  source "$HOME/.zshrc.local"
fi

